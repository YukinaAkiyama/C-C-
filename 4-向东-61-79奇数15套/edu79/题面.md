
# CSP2021-训练-01

难度系数-$1325$

**一．题目概况**

| 中文题目名称 |  新年  | 圣诞诗歌 | 礼物堆叠 |  圣诞机器人  |
| :----------: | :-------: | :---------: | :-------: | :----------: |
| 可执行文件名 | year.cpp | verse.cpp | stack.cpp | bot.cpp |
|  输入文件名  | year.in | verse.in | stack.in | bot.in |
|  输出文件名  | year.out | verse.out | stack.out | bot.out |
|   时间限制   |  1000ms  |   1000ms   |   1000ms   |  5000ms  |
|   空间限制   | 256M   |   256M   |   256M   |   256M    |

**二．注意事项：**
1、文件名（程序名和输入输出文件名）必须使用英文小写。
2、C/C++中函数main()的返回值类型必须是int，程序正常结束时的返回值必须是 0。
3、结果比较方式 ： 全文比较（过滤行末空格及文末回车）  。
4、特别提醒：评测在当前最新公布的 $NOI$ $Linux$ 下进行。
5、本次测试需要使用文件读写。

<div STYLE="page-break-after: always;"></div> 
## 1 新年  （year）
时间限制：$ 1 \ sec$ ；空间限制：$256\  MB$

### 题目描述

给定 $r$ 个字符 R，$g$ 个字符 G，$b$ 个字符 B，问是否存在一种方案，使得所有字符排列组成的字符串不存在两个相邻且相同的字符。

### 输入格式

**本题有多组数据**。

第一行一个正整数 $t(1\leq t \leq 100)$，表示数据组数。

对于每组数据，一行三个整数 $r,g,b(1\leq r,g,b \leq 10^9)$。

### 输出格式

对于每组数据，如果方案存在，输出字符串 `Yes`。否则输出 `No`。

### **输入 #1**
```
3
3 3 3
1 10 2
2 1 1
```

### **输出 #1**
```
Yes
No
Yes
```

### 数据范围

### 

对于$30\%$的数据

对于$100\%$的数据$1\leq t \leq 100;$  $1\leq r,g,b \leq 10^9$

### 说明/提示

声明中描述了前两组。
例如，第三套生产花环“RBRG”。

<div STYLE="page-break-after: always;"></div> 

## 2 **圣诞诗歌**（verse）
时间限制：$ 1 \ sec$ ；空间限制：$256\  MB$

### 题目描述

给定正整数 $n，s$ 和长为 $n$ 的整数数列 $a_1,a_2,...,a_n$。

求一个最大的 $i$，使得存在一个 $j$ 满足 $1\leq j\leq i$，让 $(\sum_{k=1}^{i} a_k) -a_j \leq s$ 。

### 输入格式

**本题有多组数据**。

第一行一个正整数 $t(1\leq t\leq 100)$，表示数据组数。

对于每组数据，第一行两个正整数 $ n，s(1\leq n \leq 10^5,1\leq s \leq 10^9)$。

接下来一行 $n$ 个整数 $a_1,a_2,...,a_n(1\leq a_i \leq 10^9)$。

保证输入的 $n$ 之和不超过 $10^5$。

### 输出格式

对于每组数据，输出 $j$，意义如题意所述。如果存在多个 $j$ 输出任意一个。

特殊的，如果 $\sum_{i=1}^{n} a_i \leq s$，输出 $0$。

### **输入 #1**

```
3
7 11
2 9 1 3 18 1 4
4 35
11 9 10 7
1 8
5
```

### **输出 #1**

```
2
1
0
```

### 数据范围

对于$30\%$的数据

对于$100 \%$的数据$1\leq t\leq 100;$  $1\leq n \leq 10^5,1\leq s \leq 10^9;$  $1\leq a_i \leq 10^9;$   $n$ 之和不超过 $10^5$

### 说明/提示

在第一个测试案例中，如果 Vasya 跳过第二部分，那么他会得到三份礼物。

在第二个测试案例中，无论瓦夏跳过了经文的哪一部分。

在第三个测试案例中，瓦夏可以背诵整节经文。

<div STYLE="page-break-after: always;"></div> 

## 3  **礼物堆叠**（stack）
时间限制：$1 \ sec$ ；空间限制：$256\  MB$

### 题目描述

Santa有一个栈的礼物，编号从$1$到 $n$ ，顶部礼物的编号是$a_1$，接下来是 $a_2$……底部编号是 $a_n$ ，所有编号不唯一。
Santa有一个送礼物的清单，他必须按照清单上面的顺序送礼物，送礼物的顺序是$b_1,b_2,…,b_n$。
每次送出礼物，Santa都要从栈中找到礼物，如果某个被选中的礼物上面还有$k$个礼物，那么要花费$2*k+1$的时间将这个礼物拿出，并将其他礼物放回（可以改变这$k$个礼物的顺序）。
请回答t组测试数据分别送出礼物所花费的最短时间。

### 输入格式

第一行包含一个整数 $t (1≤t≤100)$——测试用例的数量。

然后是测试用例，每个用例由三行表示。

第一行包含两个整数 $n$ 和 $m (1≤m≤n≤10^5)$——分别是堆栈中的礼物数量和圣诞老人想要发送的礼物数量。

第二行包含$n$个整数$a_1、a_2、...、a_n$（$1≤a_i≤n$，所有$a_i$都是唯一的）——栈中的呈现顺序。

第三行包含 $m$ 个整数 $b_1, b_2, ..., b_m$（$1≤b_i≤n$，所有 $b_i$ 都是唯一的）——圣诞老人必须发送的礼物的有序列表。

所有测试用例的 $n$ 之和不超过 $10^5$。

### 输出格式

对于每个测试用例，打印一个整数——如果圣诞老人每次将礼物返回到堆栈中时都以最佳方式重新排序礼物，那么他发送礼物必须花费的最小秒数。

### **输入 #1**

```
2
3 3
3 1 2
3 2 1
7 2
2 1 7 3 4 5 6
3 1
```

### **输出 #1**

```
5
8
```

### 数据范围

对于$30\%$的数据

对于$100\%$ 的数据$1≤t≤100;$  $1≤m≤n≤10^5;$  $1≤a_i≤n;$  $1≤b_i≤n;$  $n$ 之和不超过 $10^5$



## 4 圣诞机器人（bot）

时间限制：$5 \ sec$ ；空间限制：$256\  MB$

### 题目描述

- 给定 $n$ 个集合 $a_1,\cdots ,a_n$。第 $i$ 个集合 $a_i$的大小为 $k_i$。
- 现有一个程序，这个程序会等概率地选出一个数 $x\ (1\le x\le n)$，在集合 $a_x$ 中等概率地选出一个元素 $y$，并等概率地再选出一个数 $z\ (1\le z\le n)$。
- 求 $y \in a_z$ 的概率。
- $1 \le n \le 10^6$，$1 \le k_i, a_{i,j} \le 10^6$，$\sum\limits_{i=1}^nk_i \le 10^6 i=1$。输出答案在模 $998244353$ 意义下的逆元。

### 输入格式

第一行包含一个整数 $n ( 1 \le n \le 10^6)$——给圣诞老人写信的孩子的数量。

然后是 $n$ 行，其中第 $i$ 行包含第 $i$ 个孩子想要的物品列表，格式如下：$k_i$  $a_{i, 1}a_{i, 2}... a_{i, k_i}$ $( 1 \le k_i, a_{i, j} \le 10^6)$, 其中 $k_i$是第 $i$ 个孩子想要的物品数量，$a_{i, j}$物品本身。 同一个列表中不会多次包含任何项目。

保证 $\sum \limits_{i = 1}^{n} k_i \le 10^6$.

### 输出格式

打印机器人产生有效决策的概率如下：

让这个概率表示为一个不可约分数 $\frac{x}{y}$
. 你必须打印 $x \cdot y^{-1} \mod 998244353$，其中 $y^{-1}$是 $y$ 模 $998244353$ 的逆元素（这样的整数使得 $y \cdot y^{-1}$有余数 $1$ 模 $998244353$）。

### **输入 #1**

```
2
2 2 1
1 1
```

### **输出 #1**

```
124780545
```

### **输入 #2**

```
5
2 1 2
2 3 1
3 2 4 3
2 1 4
3 4 3 2
```

### **输出 #2**

```
798595483
```

### 数据范围

对于$30\%$的数据

对于 $100\%$ 的数据$1 \le n \le 10^6$，$1 \le k_i, a_{i,j} \le 10^6$，$\sum\limits_{i=1}^nk_i \le 10^6 i=1$




